---
title: "Illustrative Examples of Imaginary Structures"
output:
  html_document: default
  pdf_document: default
---
This doc shows some illustrative examples of imaginary structures in CSS data.

## Glossary
- __P-EO__: Partially false errors of omission
- __P-EC__: Partially false errors of commission
- __C-EO__: Completely false errors of omission
- __C-EC__: Completely false errors of commission

## Installation
To calculate imaginary structure statistics, you can install the `imaginarycss` package from [CRAN](https://CRAN.R-project.org).

```r
# install.packages("imaginarycss")
```
Or you can also install the development version from [GitHub](https://github.com/).
``` r
# install.packages("devtools")
# devtools::install_github("gvegayon/imaginary-structures/imaginarycss@main")
```

## 3-node Graph Case with 2-node Imaginary Motifs
First, we define a true graph. In this case, the true graph includes 3 nodes and 3 edges. It also has all the possible dyadic MAN conditions:

- mutual
- asymmetric
- null

Consequently, this true graph example can cover all the possible dyadic imaginary motifs, compared to different perceived graph patterns.

In the following, we're also going to construct three perceived graphs that compare with the true graph. we calculate example imaginary motif statistics using these examples.

```{r message = FALSE, warning = FALSE}
library(sna)
library(imaginarycss)
library(ergmito)
```

```{r true graph}
# library(imaginarycss)
# 3 actor true graph
t_source_ <- c("A","A","B") 
t_target_ <- c("B","C","A")
t_source <- c(1,1,2)
t_target <- c(2,3,1)
t_ <- as.network(data.frame(from = t_source_,
                      to = t_target_))
coords <- gplot(
  t_, displaylabels = T, usecurve = T, edge.curve = .1,
  main = "True", jitter = FALSE
  )
```

### A's perceived graph
We define A's perceived graph and then compare it with the true graph. By doing so, we should obverse the following imaginary 2-node motifs:

- P-EO = 1
- P-EC = 1
- C-EO = 0
- C-EC = 0


```{r A graph}
# A's perceived graph
a_source_ <- c("A","A","C")
a_target_ <- c("B","C","A")
a_source <- c(1,1,3)
a_target <- c(2,3,1)
a_ <- as.network(data.frame(from = a_source_,
                 to = a_target_))
gplot(
  a_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "A", jitter = FALSE
  )
```

### B's perceived graph
Compared to the true graph, B should provide the following imaginary 2-node motifs:

- P-EO = 0
- P-EC = 0
- C-EO = 2
- C-EC = 3

```{r B graph}
# C's perceived graph
b_source_ <- c("C","B","C")
b_target_ <- c("A","C","B")
b_source <- c(3,2,3) -1
b_target <- c(1,3,2) -1
b_ <- as.network(data.frame(from = b_source_,
                            to = b_target_),matrix.type='edgelist')
gplot(
  b_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "B", jitter = FALSE
  )
```

### C's perceived graph
This should be C's perceived graph statistics:

- P-EO = 2
- P-EC = 1
- C-EO = 0
- C-EC = 0

```{r C graph}
# C's perceived graph
c_source_ <- c("C","B")
c_target_ <- c("A","A")
c_source <- c(3,2) -1
c_target <- c(1,1) -1
c_ <- as.network(data.frame(from = c_source_,
                      to = c_target_),matrix.type='edgelist')
gplot(
  c_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "C", jitter = FALSE
  )
```

### Count Imaginary Errors

```{r all-three, echo = FALSE}
op <- par(mfcol=c(2, 2), mar = rep(1, 4))
gplot(
  t_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "True", jitter = FALSE
  )
gplot(
  a_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "A", jitter = FALSE)

gplot(
  b_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "B", jitter = FALSE)

gplot(
  c_, displaylabels = T, usecurve = T, edge.curve = .1,
  coord = coords, main = "C", jitter = FALSE)
par(op)
```


Let's count errors using `count_recip_errors` in the imaginary_css package.

```{r Errors}
big_graph <- blockdiagonalize(list(t_, a_, b_)) #
graph <- new_barry_graph(as.matrix(big_graph), n = 3)

ans <- count_recip_errors(graph)
ans$name <- gsub("[(][0-9]+[)]", "", ans$name)
ans
```